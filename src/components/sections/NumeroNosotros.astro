---
import NumeroNosotrosImg from "../../assets/NumeroNosotros.png";
import uno from "../../../public/1.png";
import dos from "../../../public/2.png";
import tres from "../../../public/3.png";
import { getNumeroNosotros } from "../../services/api";

const historyData = await getNumeroNosotros();

interface HistoryItem {
  field: string;
  info: string;
  list: any[];
}
// const textoUno = NumeroNosotrosData.historyHow1Text || "";
// const textoDos = NumeroNosotrosData.historyHow2Text || "";
// const textoTres = NumeroNosotrosData.historyHow3Text || "";

// const quillUno = NumeroNosotrosData.historyHow1Quill || "";
// const quillDos = NumeroNosotrosData.historyHow2Quill || "";
// const quillTres = NumeroNosotrosData.historyHow3Quill || "";

const numeros = [
  {
    imagen: uno,
    color : "verde",
    titulo: historyData.historyHow1Text || "",
    descripcion: historyData.historyHow1Quill || "",
  },
  {
    imagen: dos,
  color: "verde",
  titulo: historyData.historyHow2Text || "",
  descripcion: historyData.historyHow2Quill || "",
  },
  {
    imagen: tres,
     color: "negro",
     titulo: historyData.historyHow3Text || "",
     descripcion: historyData.historyHow3Quill || "",
  },
];
---

<script>
  // Script para el carrusel móvil
  document.addEventListener("DOMContentLoaded", function () {
    const carousel = document.getElementById("numero-mobile-carousel");
    const slides = carousel?.querySelectorAll(".numero-carousel-slide");
    const prevBtn = document.getElementById("numero-prev-btn");
    const nextBtn = document.getElementById("numero-next-btn");
    const indicators = document.querySelectorAll(".numero-carousel-indicator");

    let currentSlide = 0;
    const totalSlides = slides?.length || 0;

    function showSlide(index: number) {
      if (!slides) return;

      slides.forEach((slide, i) => {
        slide.classList.toggle("hidden", i !== index);
      });

      indicators.forEach((indicator, i) => {
        indicator.classList.toggle("bg-verdeArk", i === index);
        indicator.classList.toggle("bg-gray-300", i !== index);
      });
    }

    function nextSlide() {
      currentSlide = (currentSlide + 1) % totalSlides;
      showSlide(currentSlide);
    }

    function prevSlide() {
      currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
      showSlide(currentSlide);
    }

    // Event listeners
    nextBtn?.addEventListener("click", nextSlide);
    prevBtn?.addEventListener("click", prevSlide);

    // Auto-play (opcional)
    setInterval(nextSlide, 5000);

    // Inicializar
    showSlide(0);
  });
</script>
<section class="flex flex-col items-center justify-center w-full mx-auto my-5 bg-white lg:my-20 max-w-7xl">
  <div class="container px-6 mx-auto">
    {/* Carrusel para móvil - Solo visible en pantallas pequeñas */}
    <div id="numero-mobile-carousel" class="block md:hidden">
      <div class="relative">
        {
          numeros.map((item, index) => (
            <div class={`numero-carousel-slide flex flex-col items-center text-center ${index === 0 ? "" : "hidden"}`}>
              <div class="mb-4">
                <img
                  src={item.imagen.src}
                  alt={`Número ${item.imagen === uno ? "1" : item.imagen === dos ? "2" : "3"}`}
                  class="object-contain w-20 h-20"
                  draggable="false"
                />
              </div>
              <h3 class={`text-lg font-bold mb-4 uppercase font-akira-bold ${item.color === "verde" ? "text-verdeArk" : "text-black"}`}>{item.titulo}</h3>
              <p class="px-4 text-sm leading-relaxed text-black">{item.descripcion}</p>
            </div>
          ))
        }

        {/* Botones de navegación */}
        <button
          id="numero-prev-btn"
          class="absolute left-0 p-2 transition-colors transform -translate-y-1/2 bg-white rounded-full shadow-lg top-1/2 hover:bg-gray-50"
          aria-label="Slide anterior"
        >
          <svg class="w-6 h-6 text-verdeArk" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>

        <button
          id="numero-next-btn"
          class="absolute right-0 p-2 transition-colors transform -translate-y-1/2 bg-white rounded-full shadow-lg top-1/2 hover:bg-gray-50"
          aria-label="Siguiente slide"
        >
          <svg class="w-6 h-6 text-verdeArk" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>

      {/* Indicadores */}
      <div class="flex justify-center mt-6 space-x-2">
        {
          numeros.map((_, index) => (
            <button
              class={`numero-carousel-indicator w-3 h-3 rounded-full transition-colors ${index === 0 ? "bg-verdeArk" : "bg-gray-300"}`}
              aria-label={`Ir al slide ${index + 1}`}
            />
          ))
        }
      </div>
    </div>

    {/* Grid para desktop - Solo visible en pantallas medianas y grandes */}
    <div class="hidden grid-cols-1 gap-8 md:grid md:grid-cols-3 lg:gap-20">
      {
        numeros.map((item) => (
          <div class="flex flex-col items-center text-center">
            <div class="mb-4">
              <img
                src={item.imagen.src}
                alt={`Número ${item.imagen === uno ? "1" : item.imagen === dos ? "2" : "3"}`}
                class="object-contain w-24 h-24 lg:w-32 lg:h-32"
                draggable="false"
              />
            </div>
            <h3 class={`text-xl lg:text-2xl font-bold mb-4 uppercase font-akira-bold ${item.color === "verde" ? "text-verdeArk" : "text-black"}`}>
              {item.titulo}
            </h3>
            <p class="text-sm leading-relaxed text-black lg:text-lg">{item.descripcion}</p>
          </div>
        ))
      }
    </div>
  </div>
</section>
